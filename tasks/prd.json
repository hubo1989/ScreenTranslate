{
  "name": "截图翻译流程优化与显示重构",
  "branchName": "feat/refactor-translate",
  "userStories": [
    {
      "id": "US-001",
      "title": "翻译按钮始终可点击",
      "description": "As a user, I want to click the translate button at any time so that I don't have to wait for OCR to complete first.",
      "acceptanceCriteria": [
        "翻译按钮在截图完成后立即可用（不再等待 OCR）",
        "TranslateButtonView 移除对 ocrCompleted 状态的依赖",
        "按钮样式始终为可点击状态"
      ],
      "priority": 1,
      "passes": true,
      "dependsOn": [],
      "completionNotes": "Completed by agent"
    },
    {
      "id": "US-002",
      "title": "点击翻译自动触发 OCR",
      "description": "As a user, I want clicking translate to automatically perform OCR first (if not done) so that the workflow is seamless.",
      "acceptanceCriteria": [
        "点击翻译时检查 OCR 是否已完成",
        "若未完成，先执行 OCR，完成后自动继续翻译",
        "若已完成，直接进行翻译",
        "显示适当的加载状态（如\"正在识别并翻译...\"）",
        "OCR 或翻译失败时显示错误提示"
      ],
      "priority": 1,
      "passes": false,
      "dependsOn": [
        "US-001"
      ]
    },
    {
      "id": "US-003",
      "title": "读取翻译显示位置设置",
      "description": "As a user, I want the app to respect my display preference setting so that translations appear where I configured.",
      "acceptanceCriteria": [
        "找到并读取现有的翻译显示位置设置项",
        "若设置项不存在，新增设置项（覆盖原文 / 原文下方）",
        "翻译完成后根据设置决定显示方式",
        "设置变更后立即生效"
      ],
      "priority": 2,
      "passes": false,
      "dependsOn": [
        "US-002"
      ]
    },
    {
      "id": "US-004",
      "title": "覆盖原文模式 - 内容感知填充",
      "description": "As a user, I want the original text area to be intelligently filled before showing translation so that the result looks clean.",
      "acceptanceCriteria": [
        "使用 OCR 返回的文字块坐标定位原文区域",
        "尝试使用 macOS 内容感知填充 API（如 Core Image 的 inpainting）",
        "若无合适 API，fallback 到模糊滤镜或背景色填充",
        "填充后在该区域渲染译文"
      ],
      "priority": 2,
      "passes": false,
      "dependsOn": [
        "US-003"
      ]
    },
    {
      "id": "US-005",
      "title": "覆盖原文模式 - 译文渲染",
      "description": "As a user, I want translations to be rendered in place of original text so that I can see the translated content naturally.",
      "acceptanceCriteria": [
        "在填充后的区域绘制译文",
        "译文字体大小根据区域高度自动调整",
        "若译文较长，允许向右/下延伸超出原区域",
        "译文颜色与背景形成足够对比"
      ],
      "priority": 2,
      "passes": false,
      "dependsOn": [
        "US-004"
      ]
    },
    {
      "id": "US-006",
      "title": "原文下方模式 - 译文渲染",
      "description": "As a user, I want translations to appear below each text block so that I can compare original and translated text.",
      "acceptanceCriteria": [
        "在每个 OCR 识别的文字块下方显示对应译文",
        "译文与原文对齐（左对齐或居中，视原文情况）",
        "若译文较长，允许向右/下延伸",
        "译文使用区分性样式（如不同颜色或半透明背景）"
      ],
      "priority": 2,
      "passes": false,
      "dependsOn": [
        "US-003"
      ]
    },
    {
      "id": "US-007",
      "title": "Preview 窗口图片渲染",
      "description": "As a user, I want to see the translated result directly on the image in the Preview window so that I get immediate visual feedback.",
      "acceptanceCriteria": [
        "在 ScreenshotPreviewView 中的图片上渲染译文",
        "使用 overlay 或自定义绘制层实现",
        "渲染层不影响原始截图数据",
        "支持实时切换显示模式"
      ],
      "priority": 2,
      "passes": false,
      "dependsOn": [
        "US-005",
        "US-006"
      ]
    },
    {
      "id": "US-008",
      "title": "保留底部面板作为备用",
      "description": "As a user, I want the bottom results panel to remain available so that I can still see plain text results if needed.",
      "acceptanceCriteria": [
        "保留 resultsPanel 组件和功能",
        "面板可折叠或默认收起",
        "面板仍显示原文和译文的纯文本版本",
        "面板文本可复制"
      ],
      "priority": 3,
      "passes": false,
      "dependsOn": [
        "US-007"
      ]
    },
    {
      "id": "US-009",
      "title": "保存带译文的图片",
      "description": "As a user, I want to save the image with translations so that I can keep a permanent copy.",
      "acceptanceCriteria": [
        "添加\"保存图片\"按钮",
        "将渲染后的图片（含译文）保存为 PNG/JPEG",
        "提供文件保存对话框选择位置",
        "保存成功后显示确认提示"
      ],
      "priority": 3,
      "passes": false,
      "dependsOn": [
        "US-007"
      ]
    },
    {
      "id": "US-010",
      "title": "复制带译文的图片到剪贴板",
      "description": "As a user, I want to copy the translated image to clipboard so that I can quickly paste it elsewhere.",
      "acceptanceCriteria": [
        "添加\"复制图片\"按钮",
        "将渲染后的图片（含译文）复制到系统剪贴板",
        "复制成功后显示确认提示（如短暂的 toast）",
        "支持直接粘贴到其他应用"
      ],
      "priority": 3,
      "passes": false,
      "dependsOn": [
        "US-007"
      ]
    },
    {
      "id": "US-011",
      "title": "修复编辑框尺寸与原框选一致",
      "description": "As a user, I want the screenshot editor to show the exact size I selected so that what I see matches what I captured.",
      "acceptanceCriteria": [
        "ScreenshotPreviewView 中图片显示为原始尺寸（1:1）",
        "移除任何缩放逻辑或固定尺寸约束",
        "若图片超出窗口，使用 ScrollView 允许滚动查看",
        "窗口大小可调整，图片始终保持原始比例"
      ],
      "priority": 1,
      "passes": false,
      "dependsOn": []
    }
  ],
  "metadata": {
    "updatedAt": "2026-02-04T13:37:40.747Z"
  }
}